# 图片水印工具使用指南

## 功能概述

本工具为微信小程序提供了强大的图片水印功能，支持多种水印类型和丰富的自定义选项。

## 主要功能

### 1. 水印类型
- **文字水印**: 添加自定义文字水印
- **图片水印**: 使用图片作为水印
- **重复水印**: 平铺式文字水印效果

### 2. 自定义选项
- **位置控制**: 精确设置水印位置 (X, Y 坐标)
- **字体大小**: 12px - 48px 可调
- **透明度**: 10% - 100% 可调
- **旋转角度**: -180° 到 180° 可调
- **颜色选择**: 6种预设颜色可选
- **文字内容**: 完全自定义

### 3. 图片处理
- **高质量输出**: 支持PNG格式输出
- **保存到相册**: 一键保存处理后的图片
- **分享功能**: 支持微信分享
- **预览功能**: 实时预览处理效果

## 使用步骤

### 1. 选择图片
- 点击"点击选择图片"按钮
- 可以从相册选择或拍照
- 支持常见图片格式 (JPG, PNG等)

### 2. 配置水印
- 点击"水印配置"按钮打开配置面板
- 选择水印类型 (文字/图片/重复)
- 调整各项参数:
  - 文字内容
  - 位置坐标
  - 字体大小
  - 透明度
  - 旋转角度
  - 颜色选择

### 3. 处理图片
- 点击"添加水印"按钮
- 等待处理完成
- 查看处理结果

### 4. 保存或分享
- 点击"保存到相册"保存图片
- 点击"分享图片"分享给好友

## 技术特性

### Canvas 2D API
- 使用微信小程序 Canvas 2D API
- 支持高分辨率图片处理
- 自动适配设备像素比

### 性能优化
- 异步图片加载
- 内存管理优化
- 处理进度提示

### 权限管理
- 自动请求相册权限
- 友好的权限提示
- 引导用户授权

## 代码结构

```
/workspace/
├── utils/
│   └── watermark.js          # 水印处理核心类
├── pages/
│   └── watermark/
│       ├── watermark.js      # 页面逻辑
│       ├── watermark.wxml    # 页面结构
│       ├── watermark.wxss    # 页面样式
│       └── watermark.json    # 页面配置
└── app.json                  # 应用配置 (已更新)
```

## 核心类说明

### WatermarkProcessor
主要方法:
- `initCanvas()`: 初始化Canvas
- `loadImage()`: 加载图片
- `addTextWatermark()`: 添加文字水印
- `addImageWatermark()`: 添加图片水印
- `addRepeatingWatermark()`: 添加重复水印
- `exportToImage()`: 导出图片
- `saveToAlbum()`: 保存到相册

## 注意事项

1. **图片大小**: 建议单张图片不超过10MB
2. **处理时间**: 大图片处理可能需要几秒钟
3. **权限授权**: 首次保存需要授权相册权限
4. **兼容性**: 需要微信版本7.0.0以上

## 扩展功能

### 可添加的功能
- 更多水印样式 (阴影、描边等)
- 批量处理多张图片
- 水印模板保存
- 更多图片格式支持
- 云端处理服务

### 自定义开发
开发者可以根据需要扩展 `WatermarkProcessor` 类，添加更多水印效果和处理功能。

## 技术支持

如有问题或建议，请查看代码注释或联系开发团队。